<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prefects Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
	<script>
    
document.addEventListener('DOMContentLoaded', function () {
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    const userRank = localStorage.getItem('userRank');

    if (!isLoggedIn || !['TEACHER', 'SMT', 'ADMINISTRATOR', 'PREFECT'].includes(userRank)) {
        alert('You must be logged in to view this page.');
        window.location.href = 'index.html'; // Redirect to login page
    }
});
</script>
	
	<style>
        body {
            background-color: #dff0d8;
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 600px;
            margin-top: 50px;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            position: relative;
        }
        .logo {
            display: block;
            margin: 0 auto 20px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #3c763d;
            text-align: center;
            line-height: 100px;
            font-size: 24px;
            color: white;
            font-weight: bold;
        }
        h1 {
            text-align: center;
            color: #3c763d;
        }
        h3 {
            text-align: center;
            color: #3c763d;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .btn-primary, .btn-secondary {
            background-color: #3c763d;
            border: none;
            width: 100%;
            margin-top: 10px;
        }
		
	
		
		
        .btn-primary:hover, .btn-secondary:hover {
            background-color: #2e6b2f;
        }
		.btn-danger {
            background-color: #d9534f;
            border: none;
			width: 100%;
        }
        .btn-danger:hover {
            background-color: #c9302c;
        }
		
		
		.conditional-input {
            display: none;
        }


        .app-title {
            text-align: center;
            font-size: 12px;
            color: #3c763d;
            margin-top: 5px;
            font-weight: bold;
            font-family: "Georgia", serif;
        }
        .developer-credit {
            text-align: center;
            font-size: 12px;
            color: #3c763d;
            margin-top: 20px;
            font-style: italic;
            font-family: "Georgia", serif;
        }
        .clear-btn {
            background-color: #d9534f;
            color: white;
            border: none;
            margin-left: 5px;
        }
        .clear-btn:hover {
            background-color: #c9302c;
        }
        .font-adjust-section {
            text-align: center;
            margin-bottom: 15px;
            padding: 10px 0;
            border-top: 1px solid #dcdcdc;
            border-bottom: 1px solid #dcdcdc;
        }
        .font-adjust-section label {
            font-size: 16px;
            color: #3c763d;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
        }
        .font-adjust-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .font-btn {
            background-color: #3c763d;
            color: white;
            border: none;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, background-color 0.2s;
        }
        .font-btn:hover {
            background-color: #2e6b2f;
            transform: scale(1.1);
        }






		
        .gear-container {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            align-items: center;
        }
        .gear-button {
            background: none;
            border: none;
            cursor: pointer;
            margin-right: 10px;
        }
        .gear-button img {
            width: 30px;
            height: 30px;
        }
        .gear-label {
            font-weight: bold;
            color: #3c763d;
        }
        .two-column {
            display: flex;
            justify-content: space-between;
        }
        .two-column .form-group {
            width: 48%;
        }
        .form-container {
            display: none;
        }
        #studentExitRecords, #studentAttendanceRecords, #teacherDutyRecords, #reportstudents, #reportteachers, #morningSession, #afternoonSession, #blockButtons {
            display: none;
        }
		
		  #settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        .modal-button {
            width: 100%;
            margin-top: 10px;
        }
        .btn-report {
            background-color: #0275d8;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn-report:hover {
            background-color: #025aa5;
        }
        .block-btns {
            margin-bottom: 20px;
            text-align: center;
        }
		        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
            display: none; /* Initially hide all tables */
        }
        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #ddd;
        }
        th {
            background-color: #3c763d;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .table-container {
            margin-top: 20px;
        }
		
		
		
		 #scrollTopBtn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 99;
            font-size: 18px;
            border: none;
            outline: none;
            background-color: rgba(60, 118, 61, 0.7);
            color: white;
            cursor: pointer;
            padding: 15px;
            border-radius: 50%;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }
        #scrollTopBtn:hover {
            opacity: 1;
        }
		
	
    </style>
	
	<style>
    body.fade-out {
        opacity: 0;
        transition: opacity 0.5s ease-out;
    }

    body.fade-in {
        opacity: 0;
        animation: fadeIn 0.5s ease-in forwards;
    }

    @keyframes fadeIn {
        to {
            opacity: 1;
        }
    }
</style>
	
	
	
	
	
	
</head>
<body>
<!-- Prefect Landing Page -->
    <div id="prefects_landing_page">
    <div class="container py-4">
         <div class="gear-container">
            <span class="gear-label" id="gear-label"></span>
            <button class="gear-button" onclick="openSettings()">
                <img src="https://www.freeiconspng.com/uploads/settings-icon-16.png" alt="Settings">
            </button>
        </div>
		<div class="logo">HSRMS</div>
        <h1>Prefects Dashboard</h1>

<br>
		
<button class="btn btn-secondary" onclick="navigateWithFade('late_attendance.html')">Late Attendance</button>


		
<br>

<button class="btn btn-secondary" >Duty Attendance</button>
        		
		

<br><br>
<button class="btn btn-danger btn-block" onclick="logout()">Logout</button>
  
		   
		   
		   
        </div>
		
		
		


		
	
<!-- Settings Modal -->
        <div id="settings-modal" style="display: none;">
            <div class="modal-content">

            <label id="user-nid">NID</label> <!-- Dynamic NID -->
    		<label id="user-name"></label> <!-- Dynamic Name -->

            <br>
            <label>Current Password:</label>
            <label id="current-password"></label> <!-- Fetched password -->

<div class="form-group d-flex align-items-center mt-2">
    <input type="password" id="new-password" class="form-control me-2" placeholder="Update Password">
    <button class="btn btn-primary uniform-btn" onclick="updatePassword()">U</button>
</div>



<div class="form-group d-flex align-items-center mt-2">
    <input type="range" id="font-size-meter" class="form-control-range me-2" min="10" max="30" value="16" oninput="updateFontSizeLabel()">
    <label id="font-size-label" class="me-2">16px</label>
    <button class="btn btn-primary uniform-btn" onclick="applyFontSize()">U</button>
</div>

		<button class="btn btn-secondary" onclick="closeSettings()">Close</button>
		  </div>
        </div>	
		

		<button id="scrollTopBtn" onclick="scrollToTop()">Top</button>
	
    <div class="developer-credit">Developed by: Mifthah Ahmed</div>
	
		
  
    <script>
        
		


     
        function logout() {
            
              localStorage.removeItem('isLoggedIn');
  localStorage.removeItem('userRank');
  localStorage.removeItem('teacherName');
  localStorage.removeItem('phoneNumber');
            alert('Logged out successfully');
           
            window.location.href = 'index.html'; 
        }
       
		
		
	    document.addEventListener('DOMContentLoaded', () => {
   
    const phoneNumber = localStorage.getItem('phoneNumber'); // Retrieve the phone number

 
    if (phoneNumber) {
        document.querySelector('#settings-modal label[id="user-nid"]').innerText = phoneNumber; // Set the phone number to Label 1
       
   }

});
	


 function openSettings() {
        const nid = document.getElementById('user-nid').innerText;
        const rank = localStorage.getItem('userRank');

        const action = rank === 'PREFECT' ? 'getPrefectPassword' : 'getUserInfo';

        fetch(`https://script.google.com/macros/s/AKfycbyqv1AJXS2gggrPUt82AMLVqpQsoa4fLwiQHb5OgiqkSrGdBxkjkr7R6aHyCCPkXINV/exec?action=${action}&nid=${nid}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('current-password').innerText = data.password || 'N/A';
					document.getElementById('user-name').innerText = data.name || ''; // Set name
                    // Optional fields for staff only
                    if (rank !== 'PREFECT') {
                        document.getElementById('dob').value = data.dob || '';
                        document.getElementById('class-teacher').value = data.classTeacher || '';
                        document.getElementById('assistant-teacher').value = data.assistantTeacher || '';
                    }

                    document.getElementById('settings-modal').style.display = 'block';
                } else {
                    alert('Failed to fetch settings data.');
                }
            })
            .catch(error => console.error('Error fetching settings:', error));
    }

    // Trigger password update when the "U" key is pressed inside the input field
    document.addEventListener('keydown', function (event) {
        const modalOpen = document.getElementById('settings-modal').style.display === 'block';
        const isInputFocused = document.activeElement.id === 'new-password';

        if (event.key.toUpperCase() === 'U' && modalOpen && isInputFocused) {
            updatePassword();
        }
    });

    function updatePassword() {
        const nid = document.getElementById('user-nid').innerText;
        const newPassword = document.getElementById('new-password').value.trim();
        const rank = localStorage.getItem('userRank');

        if (!newPassword) {
            alert('Please enter a new password.');
            return;
        }

        const action = rank === 'PREFECT' ? 'updatePrefectPassword' : 'updateUserPassword';

        fetch(`https://script.google.com/macros/s/AKfycbyqv1AJXS2gggrPUt82AMLVqpQsoa4fLwiQHb5OgiqkSrGdBxkjkr7R6aHyCCPkXINV/exec?action=${action}&nid=${nid}&password=${newPassword}`, {
            method: 'POST'
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Password updated successfully!');
                    document.getElementById('current-password').innerText = newPassword;
                    document.getElementById('new-password').value = '';
                } else {
                    alert('Failed to update password.');
                }
            })
            .catch(error => {
                console.error('Error updating password:', error);
                alert('An error occurred while updating password.');
            });
    }








    function closeSettings() {
        document.getElementById('settings-modal').style.display = 'none';
    }
     
		
		
	
	

   // Function to update the font size label dynamically
    function updateFontSizeLabel() {
        const fontSizeMeter = document.getElementById('font-size-meter');
        const fontSizeLabel = document.getElementById('font-size-label');
        fontSizeLabel.textContent = `${fontSizeMeter.value}px`;
    }

    // Function to apply the selected font size to the whole website
    function applyFontSize() {
        const fontSizeMeter = document.getElementById('font-size-meter');
        const newFontSize = `${fontSizeMeter.value}px`;
        document.documentElement.style.fontSize = newFontSize; // Update the root font size
        alert(`Font size updated to ${newFontSize}`);
    }

    // Save the font size setting and apply it on page load
    document.addEventListener('DOMContentLoaded', () => {
        const savedFontSize = localStorage.getItem('websiteFontSize');
        if (savedFontSize) {
            document.documentElement.style.fontSize = savedFontSize;
            document.getElementById('font-size-meter').value = parseInt(savedFontSize, 10);
            document.getElementById('font-size-label').textContent = savedFontSize;
        }
    });

    function saveFontSizeSetting() {
        const fontSizeMeter = document.getElementById('font-size-meter');
        const newFontSize = `${fontSizeMeter.value}px`;
        localStorage.setItem('websiteFontSize', newFontSize); // Save to local storage
    }

    // Update and save the font size when the user clicks 'U' button
    function applyFontSize() {
        const fontSizeMeter = document.getElementById('font-size-meter');
        const newFontSize = `${fontSizeMeter.value}px`;
        document.documentElement.style.fontSize = newFontSize; // Update the root font size
        saveFontSizeSetting(); // Save the setting to local storage
        alert(`Font size updated to ${newFontSize}`);
    }



	
	
	
	
	
		
		
		// Function to show hidden form and focus on it
        function showForm(formId) {
            // Hide all form containers
            document.querySelectorAll('.form-container').forEach(function(container) {
                container.style.display = 'none';
            });

            // Show the selected form
            var form = document.getElementById(formId);
            form.style.display = 'block';

            // Scroll to the form and focus
            form.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Scroll-to-top button functionality
        var scrollTopBtn = document.getElementById("scrollTopBtn");

        // Show the button when the user scrolls down 20px from the top
        window.onscroll = function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                scrollTopBtn.style.display = "block";
            } else {
                scrollTopBtn.style.display = "none";
            }
        };

        // Function to scroll to the top of the page
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
		
		
		
    </script>
	
	
	<script>
    // When the page loads, fade in
    document.addEventListener("DOMContentLoaded", () => {
        document.body.classList.add("fade-in");
    });

    // Smooth navigation handler
    function navigateWithFade(url) {
        document.body.classList.remove("fade-in");
        document.body.classList.add("fade-out");

        setTimeout(() => {
            window.location.href = url;
        }, 500); // Match the transition time
    }
</script>
	
	
	
	
	
</body>
</html>
